<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>Gestionale Studio â€“ Aurelio Pezzola</title>

<style>
:root{
  --nero:#111;
  --grigio:#666;
  --bordo:#ddd;
  --bg:#f5f5f5;

  --attivo:#2ecc71;
  --urgente:#e74c3c;
  --attesa:#f1c40f;
  --archiviato:#3498db;
}

body{
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;
  margin:0;
  color:var(--nero);
}

header{
  padding:20px 32px;
  border-bottom:2px solid var(--nero);
  display:flex;
  justify-content:space-between;
  align-items:center;
}

header h1{margin:0;font-size:26px;}
header h2{margin:4px 0 0;font-size:13px;color:var(--grigio);font-weight:normal;}

button{
  padding:8px 12px;
  border:1px solid var(--nero);
  background:white;
  cursor:pointer;
}

main{padding:32px;}

.box{
  border:1px solid var(--bordo);
  padding:24px;
}

#layout{
  display:flex;
  gap:32px;
}

#lista{
  width:40%;
  list-style:none;
  padding:0;
  margin:0;
}

.item{
  border:1px solid var(--bordo);
  padding:12px;
  margin-bottom:8px;
  cursor:pointer;
  display:flex;
  gap:8px;
  align-items:center;
  background:white;
}

.drag{
  cursor:grab;
  font-weight:bold;
}

.codice{font-weight:bold;}

.tag{
  padding:2px 6px;
  font-size:12px;
  border-radius:3px;
  background:#eee;
}

.stato.attivo{background:var(--attivo);}
.stato.urgente{background:var(--urgente);color:white;}
.stato.attesa{background:var(--attesa);}
.stato.archiviato{background:var(--archiviato);color:white;}

#scheda{
  width:60%;
  border-left:1px solid var(--bordo);
  padding-left:24px;
}

.campo{margin-bottom:16px;}
label{display:block;font-size:12px;color:var(--grigio);margin-bottom:4px;}
input,select,textarea{
  width:100%;
  padding:8px;
  font-family:inherit;
}

.azioni{
  display:flex;
  gap:8px;
  margin-top:16px;
}

/* STAMPA */
@media print{
  header, #scheda, .azioni-globali{display:none;}
  #lista{width:100%;}
  body{font-size:12px;}
}
</style>
</head>

<body>

<header>
  <div>
    <h1>GESTIONALE STUDIO</h1>
    <h2>Architetto Aurelio Pezzola</h2>
  </div>
  <div class="azioni-globali">
    <button onclick="window.print()">ðŸ–¨ Stampa</button>
    <button onclick="nuovo()">ï¼‹ Nuovo lavoro</button>
  </div>
</header>

<main>
<div class="box">
  <h3>Programma Lavori</h3>
  <div id="layout">
    <ul id="lista"></ul>
    <div id="scheda"><em>Seleziona un lavoro</em></div>
  </div>
</div>
</main>

<script>
const FASI=[
"Progettazione Generale",
"Modellazione",
"Relazione Illustrativa",
"Ricerca - Studio",
"Sopralluogo Cantiere",
"Riunione - Incontro",
"Direzione Lavori - Coordinamento",
"Altro"
];

const STATI={
"Attivo":"attivo",
"Urgente":"urgente",
"In attesa":"attesa",
"Archiviato":"archiviato"
};

let progetti=JSON.parse(localStorage.getItem("progetti"))||[
{codice:"FRAM-01",titolo:"Nuovo Museo FRAM",fase:FASI[0],stato:"Attivo",note:""},
{codice:"BRE-02",titolo:"Via Cambrant",fase:FASI[3],stato:"In attesa",note:""}
];

let attivo=null;

function salva(){
  localStorage.setItem("progetti",JSON.stringify(progetti));
  render();
}

function render(){
  const ul=document.getElementById("lista");
  ul.innerHTML="";
  progetti.forEach((p,i)=>{
    const li=document.createElement("li");
    li.className="item";
    li.innerHTML=`
      <span class="drag">â˜°</span>
      <span class="codice">${p.codice}</span>
      <span>${p.titolo}</span>
      <span class="tag">${p.fase}</span>
      <span class="tag stato ${STATI[p.stato]}">${p.stato}</span>
    `;
    li.onclick=()=>apri(i);
    ul.appendChild(li);
  });
}

function apri(i){
  attivo=i;
  const p=progetti[i];
  document.getElementById("scheda").innerHTML=`
    <div class="campo">
      <label>Codice</label>
      <input value="${p.codice}" oninput="pCodice(this.value)">
    </div>
    <div class="campo">
      <label>Titolo</label>
      <input value="${p.titolo}" oninput="pTitolo(this.value)">
    </div>
    <div class="campo">
      <label>Fase</label>
      <select onchange="pFase(this.value)">
        ${FASI.map(f=>`<option ${f===p.fase?"selected":""}>${f}</option>`).join("")}
      </select>
    </div>
    <div class="campo">
      <label>Stato</label>
      <select onchange="pStato(this.value)">
        ${Object.keys(STATI).map(s=>`<option ${s===p.stato?"selected":""}>${s}</option>`).join("")}
      </select>
    </div>
    <div class="campo">
      <label>Note</label>
      <textarea rows="2" oninput="pNote(this.value)">${p.note}</textarea>
    </div>
    <div class="azioni">
      <button onclick="elimina()">Elimina</button>
    </div>
  `;
}

function pCodice(v){progetti[attivo].codice=v;salva();}
function pTitolo(v){progetti[attivo].titolo=v;salva();}
function pFase(v){progetti[attivo].fase=v;salva();}
function pStato(v){progetti[attivo].stato=v;salva();}
function pNote(v){progetti[attivo].note=v;salva();}

function nuovo(){
  progetti.push({codice:"",titolo:"Nuovo progetto",fase:FASI[0],stato:"Attivo",note:""});
  salva();
}

function elimina(){
  if(attivo===null)return;
  progetti.splice(attivo,1);
  attivo=null;
  document.getElementById("scheda").innerHTML="<em>Seleziona un lavoro</em>";
  salva();
}

document.addEventListener("keydown",e=>{
  if(e.key==="Escape"){
    attivo=null;
    document.getElementById("scheda").innerHTML="<em>Seleziona un lavoro</em>";
  }
});

render();
</script>

</body>
</html>

