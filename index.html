<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>Gestionale Studio â€“ Aurelio Pezzola</title>

<style>
:root{
  --nero:#111;
  --grigio:#666;
  --bordo:#ddd;
  --bg:#f5f5f5;

  --attivo:#2ecc71;
  --urgente:#e74c3c;
  --attesa:#f1c40f;
  --archiviato:#3498db;
}

body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;
  color:var(--nero);
}

header{
  padding:20px 32px;
  border-bottom:2px solid var(--nero);
  display:flex;
  justify-content:space-between;
  align-items:center;
}

header h1{margin:0;font-size:26px;}
header h2{margin:4px 0 0;font-size:13px;color:var(--grigio);font-weight:normal;}

button{
  padding:8px 12px;
  border:1px solid var(--nero);
  background:white;
  cursor:pointer;
}

main{padding:32px;}

.box{
  border:1px solid var(--bordo);
  padding:24px;
}

#layout{
  display:flex;
  gap:32px;
}

/* LISTA */
#lista{
  width:40%;
  list-style:none;
  padding:0;
  margin:0;
}

.item{
  border:1px solid var(--bordo);
  padding:12px;
  margin-bottom:8px;
  cursor:pointer;
  background:white;
}

.item:hover{background:var(--bg);}

.codice{font-weight:bold;margin-right:6px;}

.tag{
  display:inline-block;
  padding:2px 6px;
  font-size:12px;
  border-radius:3px;
  background:#eee;
  margin-left:4px;
}

.stato.attivo{background:var(--attivo);}
.stato.urgente{background:var(--urgente);color:white;}
.stato.attesa{background:var(--attesa);}
.stato.archiviato{background:var(--archiviato);color:white;}

/* SCHEDA */
#scheda{
  width:60%;
  border-left:1px solid var(--bordo);
  padding-left:24px;
}

.campo{margin-bottom:16px;}
label{display:block;font-size:12px;color:var(--grigio);margin-bottom:4px;}
input,textarea{width:100%;padding:8px;font-family:inherit;}

.fasi button{
  margin:4px 4px 0 0;
  padding:6px 8px;
  border:1px solid var(--bordo);
  background:#eee;
  cursor:pointer;
}

.fasi button.attiva{
  background:#ccc;
  font-weight:bold;
}

/* STAMPA */
@media print{
  header,#scheda,button{display:none;}
  #lista{width:100%;}
  body{font-size:12px;}
}
</style>
</head>

<body>

<header>
  <div>
    <h1>GESTIONALE STUDIO</h1>
    <h2>Architetto Aurelio Pezzola</h2>
  </div>
  <button onclick="window.print()">ðŸ–¨ Stampa</button>
</header>

<main>
<div class="box">
  <h3>Programma Lavori</h3>
  <button onclick="nuovo()">ï¼‹ Nuovo lavoro</button>

  <div id="layout">
    <ul id="lista"></ul>
    <div id="scheda"><em>Seleziona un lavoro</em></div>
  </div>
</div>
</main>

<script>
const FASI=[
"Progettazione Generale",
"Modellazione",
"Relazione Illustrativa",
"Ricerca - Studio",
"Sopralluogo Cantiere",
"Riunione - Incontro",
"Direzione Lavori - Coordinamento",
"Altro"
];

const STATI={
"Attivo":"attivo",
"Urgente":"urgente",
"In attesa":"attesa",
"Archiviato":"archiviato"
};

let progetti = JSON.parse(localStorage.getItem("progetti")) || [
  {codice:"FRAM-01",titolo:"Nuovo Museo FRAM",fasi:["Progettazione Generale"],stato:"Attivo",note:""}
];

let attivo = null;

function salva(){
  localStorage.setItem("progetti",JSON.stringify(progetti));
  render();
}

function render(){
  const ul=document.getElementById("lista");
  ul.innerHTML="";
  progetti.forEach((p,i)=>{
    const li=document.createElement("li");
    li.className="item";
    li.onclick=()=>apri(i);

    li.innerHTML=`
      <span class="codice">${p.codice}</span>
      ${p.titolo}
      ${p.fasi.map(f=>`<span class="tag">${f}</span>`).join("")}
      <span class="tag stato ${STATI[p.stato]}">${p.stato}</span>
    `;
    ul.appendChild(li);
  });
}

function apri(i){
  attivo=i;
  const p=progetti[i];

  document.getElementById("scheda").innerHTML=`
    <div class="campo">
      <label>Codice</label>
      <input value="${p.codice}" oninput="pCodice(this.value)">
    </div>

    <div class="campo">
      <label>Titolo</label>
      <input value="${p.titolo}" oninput="pTitolo(this.value)">
    </div>

    <div class="campo">
      <label>FASI</label>
      <div class="fasi">
        ${FASI.map(f=>`
          <button class="${p.fasi.includes(f)?'attiva':''}"
            onclick="toggleFase('${f}')">${f}</button>
        `).join("")}
      </div>
    </div>

    <div class="campo">
      <label>Stato</label>
      <select onchange="pStato(this.value)">
        ${Object.keys(STATI).map(s=>`
          <option ${s===p.stato?'selected':''}>${s}</option>
        `).join("")}
      </select>
    </div>

    <div class="campo">
      <label>Note</label>
      <textarea rows="2" oninput="pNote(this.value)">${p.note}</textarea>
    </div>

    <button onclick="elimina()">Elimina</button>
  `;
}

function pCodice(v){progetti[attivo].codice=v;salva();}
function pTitolo(v){progetti[attivo].titolo=v;salva();}
function pStato(v){progetti[attivo].stato=v;salva();}
function pNote(v){progetti[attivo].note=v;salva();}

function toggleFase(f){
  const a=progetti[attivo].fasi;
  a.includes(f)?a.splice(a.indexOf(f),1):a.push(f);
  salva();
}

function nuovo(){
  progetti.push({codice:"",titolo:"Nuovo progetto",fasi:[],stato:"Attivo",note:""});
  salva();
}

function elimina(){
  progetti.splice(attivo,1);
  attivo=null;
  document.getElementById("scheda").innerHTML="<em>Seleziona un lavoro</em>";
  salva();
}

render();
</script>

</body>
</html>
